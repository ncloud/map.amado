/*
    Cornerstone Framework v2.0

    COPYRIGHT(C) 2012 BY SKTELECOM CO., LTD. ALL RIGHTS RESERVED.
    Released under the Apache License, Version 2.0
*/
!function(a,b){function c(a,b){b?b(a):console.log("handler is not define")}function d(a,b){var d=!1;for(var e in b)a[b[e]]||(c({result:"fail",resultCode:"1",message:b[e]+" is require."},a.error),d=!0);return d}Backbone="undefined"!=typeof exports?exports:b.Backbone={};var e,f=b.SKT={authFrame:void 0},g="http://cornerstone.sktelecom.com",h=g+"/oauth/authorize",i=g+"/sms",j=g+"/payment",k=function(a){this.options=a};f.authorize=function(a){return e=new k(a),e.init(),e},f.authSuccess=function(c){for(var d=c.hash.substr(1).split("&"),g={},h=0;h<d.length;h++){var i=d[h].split("=");g[i[0]]=i[1]}return a("#"+f.authFrame)&&(a("#"+f.authFrame).remove(),f.authFrame=void 0,a(b).off("resize")),g.access_token?(e.success(decodeURIComponent(g.access_token)),void 0):(e.options.error({result:"fail",resultCode:"1",message:"access_token is not valid."}),!1)},k.prototype={defaults:{client_id:void 0,redirect_uri:void 0,response_type:"token"},init:function(){var c=["clientId","redirectUri"];if(d(this.options,c))return!1;var e={client_id:this.options.clientId,redirect_uri:encodeURI(this.options.redirectUri)};if(this.success=this.options.success,a.extend(this.defaults,e),f.authFrame)a("#"+f.authFrame).attr("src",h+"?"+a.param(this.defaults));else{f.authFrame="skt_auth_iframe_"+Math.floor(1e3*Math.random())+1;var g=a("<button>close</button>",{type:"button"}).css({left:"10px",top:"10px",position:"absolute","font-size":"15px"});g.on("click",function(){a("#"+f.authFrame).remove(),f.authFrame=void 0,a(b).off("resize")});var i=a("<div></div>",{id:f.authFrame}).css({"z-index":"10000",left:"0px",top:"0px",width:b.innerWidth+"px",height:b.innerHeight+"px",position:"absolute","background-color":"gray"});a(b).on("resize",function(a){i.css({width:a.currentTarget.innerWidth+"px",height:a.currentTarget.innerHeight+"px"}),j.css({width:a.currentTarget.innerWidth+"px",height:a.currentTarget.innerHeight+"px"})});var j=a("<iframe></iframe>",{src:h+"?"+a.param(this.defaults)}).css({width:b.innerWidth+"px",height:b.innerHeight+"px","background-color":"gray"});j.appendTo(i),g.appendTo(i),i.appendTo("body")}},success:function(){}},f.sendSms=function(b){var e=["accessToken","from","to","message"];if(d(b,e))return!1;var f={access_token:b.accessToken,from:b.from,to:b.to,message:encodeURIComponent(b.message)};a.ajax({url:i,data:f,dataType:"jsonp",jsonp:"callback",jsonpCallback:"success",timeout:b.timeout||5e3,success:function(a){1==a.resultCode?c(a,b.error):c(a,b.success)},error:function(){c({result:"fail",resultCode:"1",message:"time out."},b.error)}})},f.pay=function(b){var e=["accessToken","type","amount","to"];if("one-time"!==b.type&&"recurring"!==b.type&&e.push("paymentDate"),d(b,e))return!1;var f={access_token:b.accessToken,type:b.type,amount:b.amount,payment_date:b.paymentDate,to:b.to};a.ajax({url:j,data:f,dataType:"jsonp",jsonp:"callback",jsonpCallback:"success",timeout:b.timeout||5e3,success:function(a){1==a.resultCode?c(a,b.error):c(a,b.success)},error:function(){c({result:"fail",resultCode:"1",message:"time out."},b.error)}})}}(jQuery,window);
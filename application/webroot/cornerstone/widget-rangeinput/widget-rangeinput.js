/*
    Cornerstone Framework v2.0

    COPYRIGHT(C) 2012 BY SKTELECOM CO., LTD. ALL RIGHTS RESERVED.
    Released under the Apache License, Version 2.0
*/
!function(a,b){"function"==typeof define&&define.amd?define(["jquery","underscore","backbone","widget-touch"],b):a.RangeInput=b(a.$,a._,a.Backbone)}(window,function(a,b,c){function d(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}function f(a,b){var c=parseInt(a.css(b),10);if(c)return c;var d=a[0].currentStyle;return d&&d.width&&parseInt(d.width,10)}function g(a){var b=a.data("events");return b&&b.onSlide}function h(b,c){function h(f,g,h,i){if(void 0===h?h=g/n*u:i&&(h-=c.min),v&&(h=Math.round(h/v)*v),(void 0===g||v)&&(g=h*n/u),isNaN(h))return p;g=Math.max(0,Math.min(g,n)),h=g/n*u,(i||!k)&&(h+=c.min),k&&(i?g=n-g:h=c.max-h),h=d(h,w);var j="click"==f.type;if(y&&void 0!==l&&!j&&(f.type="onSlide",x.trigger(f,[h,g]),f.isDefaultPrevented()))return p;var m=j?c.speed:0,q=j?function(){f.type="change",x.trigger(f,[h]),p.$input.trigger(e=a.Event("end.cs.rangeInput"))}:null;return k?(s.animate({top:g},m,q),c.progress&&t.animate({height:n-g+s.height()/2},m)):navigator.userAgent.match("Android|iPhone")?s[0].style.WebkitTransform="translate3d("+g+"px,0,0)":(s.animate({left:g},m,q),c.progress&&t.animate({width:g+s.width()/2},m)),l=h,o=g,navigator.userAgent.match("Android")||this.insertingValue||b[0].value==h||(this.insertingValue=!0,b[0].value=h,this.insertingValue=!1),p.$input=b,p.inputValue=l,p.$input.trigger(e=a.Event("move.cs.rangeInput")),p}function i(){k=c.vertical||f(r,"height")>f(r,"width"),k?(n=f(r,"height")-f(s,"height"),m=r.offset().top+n):(n=f(r,"width")-f(s,"width"),m=r.offset().left)}function j(){i(),p.setValue(void 0!==c.value?c.value:c.min)}var k,l,m,n,o,p=this,q=c.css,r=a("<div><div></div><button></button></div>").data("rangeinput",p);b.before(r);var s=r.addClass(q.slider).find("button").addClass(q.handle),t=r.find("div").addClass(q.progress);a.each("min,max,step,value".split(","),function(a,d){var e=b.attr(d);parseFloat(e)&&(c[d]=parseFloat(e,10))});var u=c.max-c.min,v="any"==c.step?0:c.step,w=c.precision;void 0===w&&(w=v.toString().split("."),w=2===w.length?w[1].length:0),"range"==b.attr("type")&&b.addClass("figure inline form-control").val(c.value).attr("type","tel").attr("data-orig-type","range"),b.addClass(q.input),c.showInput?(b.addClass(q.inputGrid),r.addClass(q.sliderGrid)):b.css({display:"none"});var x=a(p).add(b),y=!0;a.extend(p,{getValue:function(){return l},setValue:function(b,c){return i(),h(c||a.Event("api"),void 0,b,!0)},getConf:function(){return c},getProgress:function(){return t},getHandle:function(){return s},getInput:function(){return b},step:function(b,d){d=d||a.Event();var e="any"==c.step?1:c.step;p.setValue(l+e*(b||1),d)},stepUp:function(a){return p.step(a||1)},stepDown:function(a){return p.step(-a||-1)}}),a.each("onSlide,change".split(","),function(b,d){a.isFunction(c[d])&&a(p).on(d,c[d]),p[d]=function(b){return b&&a(p).on(d,b),p}}),s.drag({drag:!1}).on("dragStart",function(){i(),y=g(a(p))||g(b),p.$input.trigger(e=a.Event("start.cs.rangeInput"))}).on("drag",function(a,c,d){var e=0;return b.is(":disabled")?!1:(e=isNaN(this.prevX)?d:d>this.prevX?d-this.prevX:this.prevX-d,navigator.userAgent.match("Android")&&10>e?h(a,k?c:d):h(a,k?c:d),this.prevX=d,void 0)}).on("dragEnd",function(b){p.$input.val(p.inputValue),b.isDefaultPrevented()||(b.type="change",x.trigger(b,[l])),p.$input.trigger(b=a.Event("end.cs.rangeInput"))}).click(function(a){return a.preventDefault()}),r.click(function(c){if(b.is(":disabled")||c.target==s[0])return c.preventDefault();i();var d=k?s.height()/2:s.width()/2;p.$input.trigger(a.Event("start.cs.rangeInput")),h(c,k?n-m-d+c.pageY:c.pageX-m-d),p.$input.val(p.inputValue)}),c.keyboard&&b.keydown(function(c){if(!b.attr("readonly")){var d=c.keyCode,e=-1!=a([75,76,38,33,39]).index(d),f=-1!=a([74,72,40,34,37]).index(d);return!e&&!f||c.shiftKey||c.altKey||c.ctrlKey?void 0:(e?p.step(33==d?10:1,c):f&&p.step(34==d?-10:-1,c),c.preventDefault())}}),b.on("change",function(b){if("none"===a(this).css("display"))return!1;var c=a(this).val();c!==l&&p.setValue(c,b)}),a(window).on("resize._rangeinput",function(){p.setValue(b.val())}),a.extend(b[0],{stepUp:p.stepUp,stepDown:p.stepDown}),j(),n||a(window).load(j)}return a.expr[":"].range=function(b){var c=b.getAttribute("type");return c&&"range"==c||!!a(b).filter("input").data("rangeinput")},a.fn.rangeinput=function(b){var c={min:0,max:100,step:"any",steps:0,value:0,precision:void 0,vertical:0,keyboard:!1,progress:!1,speed:100,showInput:!1,css:{input:"range",inputGrid:"col-xs-3",slider:"slider",sliderGrid:"col-xs-9",progress:"slider-bar",handle:"slide-handle"}};if(this.data("rangeinput"))return this;b=a.extend(!0,{},c,b);var d;return this.each(function(){var c=new h(a(this),a.extend(!0,{},b)),e=c.getInput().data("rangeinput",c);d=d?d.add(e):e}),d?d:this},a(function(){a("[data-plugin^='rangeinput']").each(function(){var b=a(this).data("rangeOptions");a(this).rangeinput(b)})}),c&&c.View.extend({render:function(a){return"string"==typeof a?this.$el.rangeinput(a):this.$el.rangeinput(this.options),this}})});
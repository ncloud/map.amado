/*
    Cornerstone Framework v2.0

    COPYRIGHT(C) 2012 BY SKTELECOM CO., LTD. ALL RIGHTS RESERVED.
    Released under the Apache License, Version 2.0
*/
!function(a,b,c){"function"==typeof define&&define.amd?define(["jquery"],function(d){c(d,a,b)}):c(a.jQuery,a,b)}(this,document,function(a,b,c){var d,e,f,g,h={},i=350,j=10,k="ontouchstart"in b,l=function(){};l.prototype={getXYfromEvent:function(a){if(a=a||b.event,"object"!=typeof a||a.type.match("touch.*")){for(var d,e=[],f=a.touches.length>0?a.touches:a.changedTouches,g=0,h=f.length;h>g;g++)d=f[g],e.push({x:d.pageX,y:d.pageY});return e}var i=c,j=i.body;return[{x:a.pageX||a.clientX+(i&&i.scrollLeft||j&&j.scrollLeft||0)-(i&&i.clientLeft||j&&i.clientLeft||0),y:a.pageY||a.clientY+(i&&i.scrollTop||j&&j.scrollTop||0)-(i&&i.clientTop||j&&i.clientTop||0)}]},getTouchPageXY:function(a){a.type.match("touch.*")&&a.originalEvent.touches.length>0&&(touch=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0],a.pageX=touch.pageX,a.pageY=touch.pageY)},getAngle:function(a,b){return 180*Math.atan2(b.y-a.y,b.x-a.x)/Math.PI},getDirectionFromAngle:function(a){var b,c,d={down:a>=45&&135>a,left:a>=135||-135>=a,up:-45>a&&a>-135,right:a>=-45&&45>=a};for(c in d)if(d[c]){b=c;break}return b},countFingers:function(a){return a.touches?a.touches.length:1},triggerEvent:function(a,b){b.touches=this.getXYfromEvent(b.originalEvent),b.type=a,"function"==typeof self["on"+a]&&self["on"+a].call(self,b)},drag:function(a,b){var f,g=this;return b=$.extend({x:!0,y:!0,drag:!0},b),d=d||$(c).on("mousedown mouseup touchstart touchend",function(a){g.getTouchPageXY(a);var c,h,i,j,k;if(f=$(a.target),a.type.match("mousedown|touchstart")&&f.data("drag"))c=f.position(),h=a.pageX-c.left,i=a.pageY-c.top,start=!0,d.on("mousemove.drag touchmove.drag",function(a){g.getTouchPageXY(a),j=a.pageX-h,k=a.pageY-i,props={},b.x&&(props.left=j),b.y&&(props.top=k),start&&(f.trigger("dragStart"),start=!1),b.drag&&f.css(props),f.trigger("drag",[k,j]),e=f}),a.preventDefault();else try{e&&e.trigger("dragEnd")}finally{d.off("mousemove.drag touchmove.drag"),e=null}}),a.data("drag",!0)},swipe:function(a,d){var e,k,l,m=this,d=$.extend({x:!0,y:!0,swipe:!0},d),n=$(a);return $("img",$(a)).on("mousedown",function(){return!1}),n.on("touchstart",function(a){g=(new Date).getTime(),h.start=m.getXYfromEvent(event),_fingers=m.countFingers(event),_first=!0,_event_start=event;var d=$(this)[0].getBoundingClientRect(),i=$(this)[0].clientTop||c.body.clientTop||0,j=$(this)[0].clientLeft||c.body.clientLeft||0,o=b.pageYOffset||$(this)[0].scrollTop||c.body.scrollTop,p=b.pageXOffset||$(this)[0].scrollLeft||c.body.scrollLeft;f={top:d.top+o-i,left:d.left+p-j},e=n.position(),k=a.pageX-e.left,l=a.pageY-e.top,start=!0,$(a.target).attr("href")&&$(a.target).trigger("click"),a.preventDefault()}).on("touchend.swipe.*",function(){if(h.move=m.getXYfromEvent(event),h.move){var a=h.move[0].x-h.start[0].x,b=h.move[0].y-h.start[0].y;_distance=Math.sqrt(a*a+b*b);var c=(new Date).getTime(),d=c-g;if(i>d&&_distance>j){_angle=m.getAngle(h.start[0],h.move[0]),_direction=m.getDirectionFromAngle(_angle),_gesture="swipe";var e={x:h.move[0].x-f.left,y:h.move[0].y-f.top},k={originalEvent:event,position:e,direction:_direction,distance:_distance,distanceX:a,distanceY:b,angle:_angle};"string"==typeof k.direction&&"left"===k.direction?n.trigger("swipeLeft",k):"string"==typeof k.direction&&"right"===k.direction?n.trigger("swipeRight",k):"string"==typeof k.direction&&"up"===k.direction?n.trigger("swipeUp",k):"string"==typeof k.direction&&"down"===k.direction&&n.trigger("swipeDown",k),n.trigger("swipe",k)}}}),n.data("swipe",!0)}},$.fn.drag=function(a){var b=new l;return b.drag($(this),a)},$.fn.swipe=function(a){var b=new l;return b.swipe($(this),a)},c.addEventListener("touchstart",function(){},!1),$.fn.doubletap=function(a,b){b=null==b?300:b,this.on(k?"touchend":"click",function(c){var d=(new Date).getTime(),e=$(this).data("lastTouch")||d+1,f=d-e;b>f&&f>0?($(this).data("lastTouch",null),null!==a&&"function"==typeof a&&a(c)):$(this).data("lastTouch",d)})}});